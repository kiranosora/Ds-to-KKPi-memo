\section{Branching Fraction Measurements}

\subsection{Event Selection}
\label{BFSelection}
After the selection described in Sec.~\ref{ST-selection}, we further use the double tag technique for the BF (branching fraction) measurement. 
We use the same 8 tag modes as in Sec.~\ref{AASelection}.
In the selection of tag $D_{s}$, for multiple candidates, the best candidate is chosen with $M_{rec}$ closest to mass of $D_{s}^{*}$ in~\cite{PDG2018}.
To further remove the background associated with the larger number of soft $\pi^{\pm}$ $(\pi^{0})$ from $D_{s}^{*}$ decays, candidates are voted if the momentum of $\pi^{\pm}$ ($\pi^{0}$) is less than 0.1 GeV.

The single tag (ST) yields are extracted from the fits to the $D_{s}$ invariant mass distributions, as shown in Fig.~\ref{SingleTagFit}. In the fit, the mass windows of the tag modes are set to be the same as the Ref.~\cite{Doc-DB-630-v35}.
The signal shape is modeled as MC shape convoluted with a Gaussian function, while background is parameterized as the second-order Chebychev polynomial.
The corresponding ST efficiencies are estimated from generic MC. The ST yields ($Y_{ST}$) and ST efficiencies ($\epsilon_{ST}$) are listed in Table~\ref{ST-eff}.

\begin{table}[htbp]
    \caption{ The ST yields ($Y_{ST}$) and ST efficiencies ($\epsilon_{ST}$). 
    The mass windows use the results in Ref.~\cite{Doc-DB-630-v35}. 
The BFs of the sub-particle ($K_{S}^{0}$, $\pi^{0}$, $\eta$ and $\eta^{'}$) decays are not included.}
    \label{ST-eff}
    \begin{center}
        \begin{tabular}{cccc}
            \toprule\toprule
            Tag mode & Mass window (GeV/$c^{2}$)  & $Y_{ST}$  & $\epsilon_{ST}(\%)$\\
            \hline
            $D_{s}^{-} \rightarrow K_{S}^{0}K^{-}$                          & [1.948, 1.991]    & $32399\ \pm\ 274$               & 49.48$\ \pm\ $0.07\\
            $D_{s}^{-} \rightarrow K^{+}K^{-}\pi^{-}$                       & -                 & $141189\ \pm\ 643$              & 42.17$\ \pm\ $0.03\\
            %$D_{s}^{-} \rightarrow K^{+}K^{-}\pi^{-}$                       & [1.900, 2.030]    & $135273\ \pm\ 609$              & 42.17$\ \pm\ $0.03\\
            $D_{s}^{-} \rightarrow K^{+}K^{-}\pi^{-}\pi^{0}_{\gamma\gamma}$                & [1.947, 1.982]    & $37899\ \pm\ 1739$              & 10.61$\ \pm\ $0.03\\
            $D_{s}^{-} \rightarrow K_{S}^{0}K^{-}\pi^{+}\pi^{-}$            & [1.958, 1.980]    & $7999\ \pm\ 236$               & 19.30$\ \pm\ $0.12\\
            $D_{s}^{-} \rightarrow K_{S}^{0}K^{+}\pi^{-}\pi^{-}$            & [1.953, 1.983]    & $15723\ \pm\ 290$               & 22.72$\ \pm\ $0.06\\
            $D_{s}^{-} \rightarrow \pi^{-}\pi^{-}\pi^{+}$                   & [1.952, 1.984]    & $38157\ \pm\ 873$              & 56.94$\ \pm\ $0.17\\
            $D_{s}^{-} \rightarrow \pi^{-}\eta_{\pi^{+}\pi^{-}\eta_{\gamma\gamma}}^{'}$          & [1.940, 1.996]    & $8009\ \pm\ 142$               & 20.43$\ \pm\ $0.06\\
            $D_{s}^{-} \rightarrow K^{-}\pi^{+}\pi^{-}$                     & [1.953, 1.983]    & $17112\ \pm\ 561$               & 47.18$\ \pm\ $0.22\\
            \bottomrule\bottomrule
        \end{tabular}
    \end{center}
\end{table}

\begin{figure*}[!htbp]
 \centering
 \includegraphics[width=0.35\textwidth]{plot/DsTag400_Mass_data.eps}
 \includegraphics[width=0.35\textwidth]{plot/DsTag401_Mass_data.eps}
 \includegraphics[width=0.35\textwidth]{plot/DsTag404_Mass_data.eps}
 \includegraphics[width=0.35\textwidth]{plot/DsTag405_Mass_data.eps}
 \includegraphics[width=0.35\textwidth]{plot/DsTag406_Mass_data.eps}
 \includegraphics[width=0.35\textwidth]{plot/DsTag421_Mass_data.eps}
 \includegraphics[width=0.35\textwidth]{plot/DsTag460_Mass_data.eps}
 \includegraphics[width=0.35\textwidth]{plot/DsTag502_Mass_data.eps}
 \caption{Ds Mass fits from data. The points with error bars are data, and the blue line is the fit. Red short-dashed lines are signal, violet long-dashed lines are background. The red arrows denote the signal region.  }
\label{SingleTagFit}
\end{figure*}


After a tag is identified, we search for the $D_{s}^{+} \rightarrow K^{+}K^{-}\pi^{+}$ signal process. 
For each tag mode, we may have duplicate signal candidates and the candidates with the minimum average mass ($aM$) of tag $D_{s}$ and signal $D_{s}$ are retained.


With the updated MC sample (DIY MC) based on the amplitude analysis results, the double efficiencies are determined and listed in Table~\ref{DT-eff}.

    \begin{table}[htbp]
        \caption{ The DT efficiencies ($\epsilon_{DT}$).The BFs of the sub-particle ($K_{S}^{0}$, $\pi^{0}$, $\eta$ and $\eta^{'}$) decays are not included.}
        \label{DT-eff}
        \begin{center}
            \begin{tabular}{cccc}
                \toprule\toprule
                Tag mode   & $\epsilon_{DT}(\%)$\\
                \hline
                $D_{s}^{-} \rightarrow K_{S}^{0}K^{-}$                                                   & 19.77$\pm$0.14\\
                $D_{s}^{-} \rightarrow K^{+}K^{-}\pi^{-}$                                                & 17.41$\pm$0.06\\
                $D_{s}^{-} \rightarrow K^{+}K^{-}\pi^{-}\pi^{0}$                                         &  4.69$\pm$0.03\\
                $D_{s}^{-} \rightarrow K_{S}^{0}K^{-}\pi^{+}\pi^{-}$                                     &  8.04$\pm$0.11\\
                $D_{s}^{-} \rightarrow K_{S}^{0}K^{+}\pi^{-}\pi^{-}$                                     &  9.35$\pm$0.09\\
                $D_{s}^{-} \rightarrow \pi^{-}\pi^{-}\pi^{+}$                                            & 23.72$\pm$0.15\\
                $D_{s}^{-} \rightarrow \pi^{-}\eta_{\pi^{+}\pi^{-}\eta_{\gamma\gamma}}^{'}$               &  8.70$\pm$0.11\\
                $D_{s}^{-} \rightarrow K^{-}\pi^{+}\pi^{-}$                                              & 19.68$\pm$0.13\\
                \bottomrule\bottomrule
            \end{tabular}
        \end{center}
    \end{table}

\par{
    \subsection{Analytic Strategy}
    The data sample for this analysis is collected at $E_{cm}=$4.178 GeV, about 100 MeV higher than $D_{s}^{*}D_{s}$ threshold. Around this energy region, based on the cross section measurement by CLEO~\cite{PRD80-072001}, we know that most $D_{s}$ production in $e^{+}e^{-}$ collision comes from $D_{s}^{*\pm}D_{s}^{\mp}$ events with a cross section approximate $1\ {\rm nb}$, while the cross section for $D_{s}^{+}D_{s}^{-}$ is about a factor of 20 smaller.
    The $D_{s}^{*}$ decays to either $\gamma D_{s}$ or $\pi^{0}D_{s}$ with branching fractions of $(93.5\pm0.7)\%$ and $(5.8\pm0.7)\%$~\cite{PDG2018}, respectively. 
    The other charm productions have a total cross section of $~8\ {\rm nb}$.
    %mainly including $D^{*}\bar{D}^{*}$ with a cross section of $~5 {\rm nb}$, $D^{*}\bar{D} + \bar{D}D^{*}$ with a cross section of $~2 {\rm nb}$, and $D\bar{D}$ with a cross section of relatively small $~0.2  {\rm nb}$.
    %There also appears to be $D\bar{D}^{*}\pi$ production.
    The underlying light quark ``continuum" background is about $14\ {\rm nb}$. 
    The relatively large cross sections, relatively large branching fractions, and sufficient luminosities allow us to employ double tag (DT) technique to study this study.

    As $D_{s}^{-} \rightarrow K^{+}K^{-}\pi^{-}$ is not only our signal mode but also one of our tag modes, we divide the events into two categories:

    \begin{itemize}
        \item[-] Cat. A: Tag $D_{s}$ decays to tag modes except $D_{s}^{-} \rightarrow K^{+}K^{-}\pi^{-}$. The generic MC sample with the signal removed shows no peaking background around the fit range of $1.90 < M_{sig} < 2.03 \ {\rm GeV}/c^{2}$.
            Thus, the double tag yield is determined by the fit to $M_{sig}$, shown in Fig.~\ref{DT-fit}(a). The background is described with second-order Chebychev polynomial. The double tag yield is $3497\pm64$. 
        \item[-] Cat. B: Tag $D_{s}$ decays to $K^{+}K^{-}\pi^{+}$. As both of the two $D_{s}$ mesons decay to our signal modes, we fit $aM$ (the average mass of $D_{s}$ at signal side and tag side), which is shown in Fig.~\ref{DT-fit}(b). 
            Here, the background is described by a second-order Chebychev polynomial. The double tag yield is $1651\pm42$. 
    \end{itemize}

    \begin{figure*}[!htbp]
        \centering
        \includegraphics[width=0.4\textwidth]{plot/DT-A.eps}
        \includegraphics[width=0.4\textwidth]{plot/DT-B.eps}
        \caption{Fit of (a)Cat. A and (b)Cat. B.
            We fit $M_{sig}$ and $aM$ for Cat. A and Cat. B, respectively. The signal shapes are the corresponding simulated shapes convoluted with a Gaussian function and 
        the background shapes are described with second-order Chebychev polynomial.}
        \label{DT-fit}
    \end{figure*}

    To measure the branching fraction of this decay, we start from the following equations with one tag mode:
    \begin{equation}
        N_{tag}^{obs} = 2N_{D_{s}^{+}D_{s}^{-}}\mathcal{B}_{tag}\epsilon_{tag}, \label{eq-ST}
    \end{equation}

    \begin{equation}
        \begin{array}{lr}
            N_{sig}^{obsA}=2N_{D_{s}^{+}D_{s}^{-}}\mathcal{B}_{tag}\mathcal{B}_{sig}\epsilon_{tag,sig}  , &\text{for Cat. A} \\
            N_{sig}^{obsB}=N_{D_{s}^{+}D_{s}^{-}}\mathcal{B}_{tag}\mathcal{B}_{sig}\epsilon_{tag,sig}  ,  &\text{  for Cat. B}  
        \end{array}
        \label{eq-DT}
    \end{equation}
    where $N_{D_{s}^{+}D_{s}^{-}}$ is the total number of $D_{s}^{*\pm}D_{s}^{\mp}$ produced from $e^{+}e^{-}$ collision; $N_{tag}^{obs}$ is the number of observed tag modes; $N_{sig}^{obsA}$ and $N_{sig}^{obsB}$ are the number of observed signals for Cat. A and Cat. B, respectively; $\mathcal{B}_{tag}$ and $\mathcal{B}_{sig}$ are the branching fractions of a specific tag mode and the signal mode, respectively; $\epsilon_{tag}$ is the efficiency to reconstruct the tag mode; $\epsilon_{tag,sig}$ is the efficiency to reconstruct both the tag and signal decay modes.

    Using the above equations, it's easy to obtain:
    \begin{equation}
    \mathcal{B}_{sig} = \frac{N_{sig}^{obsA}+2N_{sig}^{obsB}}{\begin{matrix}\sum_{\alpha} N_{tag}^{\alpha}\epsilon_{tag,sig}^{\alpha}/\epsilon_{tag}^{\alpha}\end{matrix}}, \label{BR-formula}
    \end{equation}
    where the yields $N_{tag}^{obsA}$, $N_{tag}^{obsB}$ and $N_{tag}^{\alpha}$ are obtained from data, while $\epsilon_{tag}$ and $\epsilon_{tag,sig}$ can be obtained from the appropriate MC samples, where $\alpha$ represents the tag modes.
    

    \subsection{Results of Branching Fraction}



    We determine the branching fraction $\mathcal{B}(D_{s}^{+} \rightarrow K^{+}K^{-}\pi^{+})=(5.47\pm0.07)\%$ (statistical uncertainty only) according to Eq.~\ref{BR-formula}.

    \subsection{Systematic Uncertainties}
    The following sources are taken in account to calculate systematic uncertainties.

    \begin{itemize}
        \item Uncertainty in the number of ST $D_{s}^{-}$ candidates. We perform alternative fits with different background shapes, signal shapes, fit ranges and bin sizes to obtain the uncertainties related to the corresponding factors.
            We change the background shape from the second-order Chebychev polynomial to a third-order Chebychev polynomial and the relative change of branching fraction is 0.18\%.
            The systematic in signal shape is determined to be 0.16\% by performing an alternative fit without convolving the Gaussian resolution function.
            For fit range, we vary the fit range from $[1.90, 2.03]$ GeV/$c^{2}$ to $[1.90, 2.02]$ GeV/$c^{2}$ and the relative difference of branching fraction is 0.24\%.
            According to Table~\ref{ST-eff}, the total ST yields of the eight tag modes is  298487 $\pm$ 2186. Then the uncertainty due to background fluctuation is 2186/298487 = 0.73\%.
            The quadrature sum of these terms, that is the uncertainty in the number of ST $D_{s}^{-}$ candidates, is 0.84\%. 
        
        \item Signal shape. The systematic uncertainty due to the signal shape is studied with the fit without the Gaussian function convoluted, the double tag yield shift is taken as the related effect. 

        \item Background shape and fit range. For background shape and the fit range in the fit, the third-order Chebychev polynomial is used to replace the nominal ones and the fit  range of $[1.90, 2.03]$ GeV/$c^{2}$ for Cat. A and $[-0.13, 0.13]$ GeV/$c^{2}$ are changed to $[1.90, 2.02]$ GeV/$c^{2}$ and $[-0.14, 0.14]$ GeV/$c^{2}$ respectively. 
            %The relative branching fraction change is taken as the related effect. 
            The largest branching fraction shift is taken as the related effect.
        
        \item Fit bias. The possible bias is estimated by the input/output check using the round 30-40 of DIY MC, which is shown in Table~\ref{BR-IO}. 
            The estimated mean ($\mu_{\mathcal{B}}$) and its uncertainty ($\sigma_{\mu}$) is calculated with the following formulas:
            \begin{equation}
            \mu_{\mathcal{B}} = \frac{\begin{matrix}\sum_{i}\frac{\mu_{i}}{\sigma_{i}^{2}}\end{matrix}}{\begin{matrix}\sum_{i}\frac{1}{\sigma_{i}^{2}}\end{matrix}}, \ \ \ \ \sigma_{\mu}^{2}=\begin{matrix}\sum_{i}\frac{1}{\sigma_{i}^{2}}\end{matrix},
            \label{BR-Combined}
            \end{equation}
            where $\mu_{i}$ and $\sigma_{i}$ are the measured branching fraction value and its statistical uncertainty for the sample i. The combined result of the round 30-40 is $\mu_{\mathcal{B}} = (5.462 \pm 0.021)\%$. 
            The relative change compared to the input value is $0.1\%$, which is very small and negligible.

            \begin{table}[htbp]
                \caption{Input/output check using the round 30-40 of generic MC.}
                \label{BR-IO}
                \begin{center}
                    \begin{tabular}{cccc}
                        \toprule\toprule
                        Round   &$\mathcal{B}(D_{s}^{+} \rightarrow K^{+}K^{-}\pi^{+})$(\%) \\
                        \hline
                        31                                  & $5.562 \pm 0.066$\\ 
                        32                                  & $5.497 \pm 0.066$\\
                        33                                  & $5.407 \pm 0.066$\\
                        34                                  & $5.636 \pm 0.068$\\
                        35                                  & $5.490 \pm 0.066$\\
                        36                                  & $5.397 \pm 0.066$\\
                        37                                  & $5.369 \pm 0.066$\\
                        38                                  & $5.490 \pm 0.067$\\
                        39                                  & $5.353 \pm 0.065$\\
                        40                                  & $5.435 \pm 0.066$\\
                        \hline
                        Combined result                               & $5.462 \pm 0.021$\\
                        \bottomrule\bottomrule
                    \end{tabular}
                \end{center}
            \end{table}

        \item $K^{\pm}$ and $\pi^{\pm}$ Tracking/PID efficiency. Based on the works~\cite{PID} and~\cite{Tracking} by Xingyu Shan and Sanqiang Qu, etc. 
            we find that it's enough to assign $1.1\%$ , $0.4\%$, $1.1\%$ and $0.2\%$ as the systematic uncertainty for $K^{\pm}$ PID, $\pi^{\pm}$ PID,  $K^{\pm}$ tracking, $\pi^{\pm}$ tracking efficiencies, respectively.

        \item MC statistics. The uncertainty of MC statistics is obtained by $\sqrt{ \begin{matrix} \sum_{i} f_{i}\frac{\delta_{\epsilon_{i}}}{\epsilon_{i}}\end{matrix}}$, where $f_{i}$ is the tag yield fraction and $\epsilon_{i}$ is the signal efficiency of tag mode $i$.
        \item Dalitz model. The uncertainty from the Dalitz model is estimated as the change of efficiency when the Dalitz model parameters are varied by their uncertainties.
    \end{itemize}

    All of the systematic uncertainties mentioned above are summarized in Table~\ref{BF-Sys}.
    \begin{table}[htbp]
        \caption{Systematic uncertainties of branching fraction.}
        \label{BF-Sys}
        \begin{center}
            \begin{tabular}{cccc}
                \toprule\toprule
                Source   & Sys. Uncertainty\\
                \hline
                Number of $D_{s}^{-}$               & 0.8 \\
                Signal shape                        & 0.5 \\
                Background shape and fit range      & 0.9 \\
                %Fit bias                            & 0.1 \\
                $K^{\pm}$ and $\pi^{\pm}$ PID efficiency            & 1.5 \\
                $K^{\pm}$ and $\pi^{\pm}$ Tracking efficiency       & 1.3 \\
                MC statistics                       & 0.2 \\
                \hline
                Dalitz model                               & 0.5 \\
                \hline
                total                               & 2.4 \\
                \bottomrule\bottomrule
            \end{tabular}
        \end{center}
    \end{table}

    The branching fraction with systematic uncertainties is $\mathcal{B}(D_{s}^{+} \rightarrow K^{+}K^{-}\pi^{+})=(5.47\pm0.07_{stat.}\pm0.13_{sys.})\%$.
    Using the FFs listed in Table~\ref{systematic-uncertainties}, the BFs for the intermediate processes can be calculated with $\mathcal{B}_{i} = FF_{i} \times \mathcal{B}(D_{s}^{+} \rightarrow K^{+}K^{-}\pi^{+})$, which are listed in Table~\ref{inter-processes}.  
    
    \begin{table}[htbp]
        \caption{The branching fractions for the intermediate processes.}
        \label{inter-processes}
        \begin{center}
            \begin{tabular}{cc}
                \toprule\toprule
                Intermediate process & Branching fractions (\%)\\
                \hline
                $D_{s}^{+} \rightarrow \bar{K}^{*}(892)^{0}K^{+}$               & $2.62\ \pm\ 0.04_{stat.}\ \pm\ 0.09_{sys.}$  \\
                $D_{s}^{+} \rightarrow \phi(1020)\pi^{+}$                       & $2.26\ \pm\ 0.05_{stat.}\ \pm\ 0.08_{sys.}$  \\
                $D_{s}^{+} \rightarrow S(980)\pi^{+}$                           & $0.90\ \pm\ 0.04_{stat.}\ \pm\ 0.11_{sys.}$  \\
                %$D_{s}^{+} \rightarrow f_{0}(980)\pi^{+}/a_{0}(980)\pi^{+}$    & $2.26\ \pm\ 0.05_{stat.}\ \pm\ 0.06_{sys.}$  \\
                $D_{s}^{+} \rightarrow \bar{K}^{*}_{0}(1430)^{0}K^{+}$          & $0.13\ \pm\ 0.02_{stat.}\ \pm\ 0.05_{sys.}$  \\
                $D_{s}^{+} \rightarrow f_{0}(1710)\pi^{+}$                      & $0.06\ \pm\ 0.01_{stat.}\ \pm\ 0.01_{sys.}$  \\
                $D_{s}^{+} \rightarrow f_{0}(1370)\pi^{+}$                      & $0.06\ \pm\ 0.01_{stat.}\ \pm\ 0.01_{sys.}$  \\
                \bottomrule\bottomrule
            \end{tabular}
        \end{center}
    \end{table}



}
